@(signupPage: Page)(implicit request: RequestHeader)

@import model.Page
@import model.EmailSubscriptions

@newsletterSignup(route: String, placeholder: String, listId: String, emailName: String) = {
    <iframe src="/email/form/@route/@listId"
        data-form-title="Sign up for @emailName"
        data-form-description=""
        data-form-campaign-code="newsletters-page"
        scrolling="no"
        seamless frameborder="0"
        class="iframed--overflow-hidden newsletter-card__iframe js-email-sub__iframe"
        data-form-success-desc="">
    </iframe>
}

@emailListCategoryList(theme: String, emailListings: List[EmailSubscription]) = {
    <div class="newsletters-category__heading">
        @theme
    </div>
    <div class="newsletter-card__wrapper">
        @emailListings.zipWithRowInfo.map { case (emailListing, row) =>
            <div class="newsletter-card newsletter-card--@emailListing.theme"
                data-component="newsletter-card @emailListing.theme">

                <div class="newsletter-card__header">

                </div>

                <div class="newsletter-card__content js-newsletter-content">

                    <div class="newsletter-card__name">@emailListing.name
                        @if(emailListing.subheading.isDefined){ @emailListing.subheading }
                    </div>

                    <div class="">
                        @emailListing.teaser

                        <div class="newsletter-card__frequency">
                            @fragments.inlineSvg("clock", "icon", List("old-article-message--clock"))
                            @emailListing.frequency
                        </div>
                    </div>
                </div>

                <div class="newsletter-card__meta js-newsletter-meta">

                    <div class="newsletter-card__iframe-wrapper">
                        @newsletterSignup("plain", "placeholder", emailListing.listId, emailListing.name)
                    </div>

                    <div class="newsletter-card__signup is-hidden">
                        <button class="button button--primary newsletter-card__lozenge newsletter-card__lozenge js-newsletter-signup-button"
                            data-link-name="Signup @emailListing.name"
                            type="button">
                            <span>Sign up</span>
                        </button>
                    </div>
                    <div class="newsletter-card__example is-hidden">
                        @if(emailListing.exampleUrl.isDefined){
                        <a href="@emailListing.exampleUrl" target="preview-email-@emailListing.listId">
                            <button class="button button--primary newsletter-card__lozenge newsletter-card__lozenge--preview"
                                data-link-name="Preview @emailListing.name"
                                type="button">
                                <span class="newsletter-card__preview">Preview  @fragments.inlineSvg("arrow-right", "icon")</span>
                            </button>
                        </a>}
                    </div>
                </div>
            </div>
        }
    </div>
}

@main(signupPage, projectName = Some("signup")) { } {
    <div class="content">
        <div class="gs-container">
            <div class="newsletters-heading">newsletters</div>

            <div class="newsletters-category" name="news">
                @emailListCategoryList("news", EmailSubscriptions.newsEmails())
            </div>
            <div class="newsletters-category" name="features">
                @emailListCategoryList("features", EmailSubscriptions.featureEmails())
            </div>
            <div class="newsletters-category" name="sport">
                @emailListCategoryList("sport", EmailSubscriptions.sportEmails())
            </div>
            <div class="newsletters-category" name="culture">
                @emailListCategoryList("culture", EmailSubscriptions.cultureEmails())
            </div>
            <div class="newsletters-category" name="lifestyle">
                @emailListCategoryList("lifestyle", EmailSubscriptions.lifestyleEmails())
            </div>
            <div class="newsletters-category" name="comment">
                @emailListCategoryList("comment", EmailSubscriptions.commentEmails())
            </div>

        </div>
    </div>
}
